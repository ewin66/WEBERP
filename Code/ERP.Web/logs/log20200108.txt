2020-01-08 19:41:50,347 [9088] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:41:50,400 [9088] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:41:50,409 [9088] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:41:50,428 [9088] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:41:50,436 [9088] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:41:50,444 [9088] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 19:42:21,454 [7656] DEBUG Servicesys_user - 获取实体对象
2020-01-08 19:42:21,485 [7656] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2020-01-08 19:42:22,054 [7656] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2020-01-08 19:42:22,221 [7656] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/8 19:42:22')
2020-01-08 19:42:22,236 [7656] DEBUG Servicemms_project - 获取实体对象
2020-01-08 19:42:22,236 [7656] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-08 19:42:22,331 [8244] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 19:42:24,090 [6884] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:09:10,072 [9088] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,112 [9088] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,185 [9088] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,186 [9088] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,194 [9088] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,194 [9088] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:09:10,927 [7636] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 20:09:14,659 [3580] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:09:19,119 [5652] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 20:09:21,110 [8904] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 20:09:21,133 [8904] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 20:10:50,427 [7172] DEBUG Servicesys_menu - 编辑记录
2020-01-08 20:10:50,477 [7172] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 20:10:50,487 [7172] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '1c0a931a-3707-4ad0-889f-332727077967'
2020-01-08 20:10:50,521 [7172] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('车间维护','10012','10000','icon-cdr_edit','/erp/[dbo].[base_area]','true','true','12','超级管理员','2020/1/8 20:10:50','超级管理员','2020/1/8 20:10:50')
2020-01-08 20:10:50,589 [7172] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"1c0a931a-3707-4ad0-889f-332727077967","MenuName":"车间维护","MenuCode":"10012","ParentCode":"10000","IconClass":"icon-cdr_edit","URL":"/erp/[dbo].[base_area]","IsVisible":"true","IsEnable":"true","MenuSeq":"12"}],"updated":[],"_changed":true}}','2020/1/8 20:10:50')
2020-01-08 20:10:50,851 [792] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 20:10:50,851 [792] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 20:10:52,758 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 20:10:52,801 [2480] DEBUG Servicesys_user - 获取动态列表
2020-01-08 20:10:52,802 [2480] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 20:10:52,816 [2480] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 20:10:52,817 [2480] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 20:10:54,622 [3580] DEBUG Servicesys_role - 获取实体列表
2020-01-08 20:10:54,624 [3580] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 20:10:59,192 [8904] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-08 20:10:59,205 [8684] DEBUG Servicesys_permission - 获取动态列表
2020-01-08 20:10:59,206 [8684] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-08 20:10:59,261 [8904] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-08 20:10:59,551 [8904] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-08 20:11:02,078 [7172] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-08 20:11:02,090 [7172] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-08 20:11:02,093 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-08 20:11:02,098 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-08 20:11:02,102 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-08 20:11:02,103 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-08 20:11:02,103 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-08 20:11:02,104 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-08 20:11:02,104 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-08 20:11:02,105 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-08 20:11:02,105 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-08 20:11:02,106 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-08 20:11:02,107 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-08 20:11:02,107 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-08 20:11:02,108 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-08 20:11:02,108 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-08 20:11:02,109 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-08 20:11:02,110 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-08 20:11:02,111 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-08 20:11:02,114 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-08 20:11:02,115 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-08 20:11:02,115 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-08 20:11:02,116 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-08 20:11:02,116 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-08 20:11:02,118 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-08 20:11:02,120 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-08 20:11:02,121 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-08 20:11:02,121 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-08 20:11:02,122 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-08 20:11:02,122 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-08 20:11:02,123 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-08 20:11:02,124 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-08 20:11:02,124 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-08 20:11:02,125 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-08 20:11:02,125 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-08 20:11:02,126 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-08 20:11:02,127 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-08 20:11:02,127 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-08 20:11:02,128 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-08 20:11:02,128 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-08 20:11:02,129 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-08 20:11:02,129 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-08 20:11:02,130 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-08 20:11:02,131 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-08 20:11:02,131 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-08 20:11:02,132 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-08 20:11:02,133 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-08 20:11:02,133 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-08 20:11:02,134 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-08 20:11:02,135 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-08 20:11:02,135 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-08 20:11:02,136 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-08 20:11:02,136 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-08 20:11:02,137 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-08 20:11:02,138 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-08 20:11:02,138 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-08 20:11:02,139 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-08 20:11:02,139 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-08 20:11:02,140 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-08 20:11:02,141 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-08 20:11:02,141 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-08 20:11:02,142 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-08 20:11:02,143 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-08 20:11:02,143 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-08 20:11:02,144 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-08 20:11:02,147 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-08 20:11:02,148 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10010')
2020-01-08 20:11:02,148 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10012')
2020-01-08 20:11:02,149 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10002')
2020-01-08 20:11:02,150 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10003')
2020-01-08 20:11:02,150 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10004')
2020-01-08 20:11:02,151 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10005')
2020-01-08 20:11:02,151 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10006')
2020-01-08 20:11:02,152 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10007')
2020-01-08 20:11:02,152 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10008')
2020-01-08 20:11:02,153 [7172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10009')
2020-01-08 20:11:02,157 [7172] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-08 20:11:02,158 [7172] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-08 20:11:02,162 [7172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-08 20:11:02,173 [7172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-08 20:11:02,176 [7172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-08 20:11:02,183 [7172] DEBUG Servicesys_role - 修改角色数据权限
2020-01-08 20:11:02,185 [7172] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-08 20:11:02,190 [7172] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-08 20:11:02,194 [7172] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-08 20:11:02,203 [7172] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-08 20:11:04,513 [2480] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 20:11:04,875 [792] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:11:05,634 [6308] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 20:11:05,645 [6308] DEBUG Servicesys_user - 获取动态列表
2020-01-08 20:11:05,645 [6308] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 20:11:05,650 [6308] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 20:11:05,650 [6308] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 20:11:06,059 [3580] DEBUG Servicesys_role - 获取实体列表
2020-01-08 20:11:06,059 [3580] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 20:11:09,948 [9164] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/process/Index','/Erp/process')
2020-01-08 20:11:09,969 [9164] DEBUG Servicebase_data - 获取动态列表
2020-01-08 20:11:09,970 [9164] DEBUG Erp - select name as value,name as text from base_data where  type =  '单位'and isenable =  '1'
2020-01-08 20:11:10,012 [9164] DEBUG Servicebase_data - 获取动态列表
2020-01-08 20:11:10,013 [9164] DEBUG Erp - select name as value,name as text from base_data where  type =  '工序'and isenable =  '1'
2020-01-08 20:11:12,241 [7172] DEBUG Servicebase_process - 获取动态列表
2020-01-08 20:11:12,241 [7172] DEBUG Erp - select top 20 * from base_Process order by id
2020-01-08 20:11:12,267 [7172] DEBUG Erp - select count(*) from ( select * from base_Process ) tb_temp
2020-01-08 20:13:51,116 [3580] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 20:13:51,574 [5672] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 20:13:51,575 [5672] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 20:14:12,323 [3580] DEBUG Servicesys_menu - 编辑记录
2020-01-08 20:14:12,323 [3580] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 20:14:12,324 [3580] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '10012'
2020-01-08 20:14:12,346 [3580] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '车间维护', [MenuCode] = '10012', [ParentCode] = '10000', [IconClass] = 'icon-cdr_edit', [URL] = '/erp/workshop', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '12', [UpdatePerson] = '超级管理员', [UpdateDate] = '2020/1/8 20:14:12' where  MenuCode =  '10012'
2020-01-08 20:14:12,391 [3580] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"10012","MenuName":"车间维护","MenuCode":"10012","ParentCode":"10000","IconClass":"icon-cdr_edit","URL":"/erp/workshop","IsVisible":"true","IsEnable":"true","MenuSeq":"12"}],"_changed":true}}','2020/1/8 20:14:12')
2020-01-08 20:14:12,684 [5672] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 20:14:12,685 [5672] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 20:14:14,586 [8992] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 20:14:14,798 [9228] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:14:15,680 [2180] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 20:14:16,496 [3580] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 20:14:16,497 [3580] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 20:14:18,435 [8684] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/workshop/Index','/Erp/workshop')
2020-01-08 20:14:20,180 [792] DEBUG Servicebase_workshop - 获取动态列表
2020-01-08 20:14:20,181 [792] DEBUG Sys - select top 20 * from base_Workshop order by id
2020-01-08 20:14:20,202 [792] ERROR Servicebase_workshop - 获取动态列表失败
System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryManyDynamic() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 150
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass43_0.<GetDynamicList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:20,289 [792] ERROR /api/erp/Workshop - System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 ERP.Web.Areas.Erp.Controllers.WorkshopApiController.Get(RequestWrapper query) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\WorkshopController.cs:行号 68
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:21,844 [6308] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/workshop/Index','/Erp/workshop')
2020-01-08 20:14:22,195 [9228] DEBUG Servicebase_workshop - 获取动态列表
2020-01-08 20:14:22,196 [9228] DEBUG Sys - select top 20 * from base_Workshop order by id
2020-01-08 20:14:22,199 [9228] ERROR Servicebase_workshop - 获取动态列表失败
System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QueryMany[TEntity,TList](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 14
   在 Zephyr.Data.DbCommand.QueryMany[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QueryMany.cs:行号 36
   在 Zephyr.Data.SelectBuilder`1.QueryManyDynamic() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 150
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass43_0.<GetDynamicList>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:22,225 [9228] ERROR /api/erp/Workshop - System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamicList(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 28
   在 Zephyr.Core.ServiceBase`1.GetDynamicListWithPaging(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 43
   在 ERP.Web.Areas.Erp.Controllers.WorkshopApiController.Get(RequestWrapper query) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\WorkshopController.cs:行号 68
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:35,009 [792] DEBUG Servicebase_workshop - 编辑记录
2020-01-08 20:14:35,010 [792] DEBUG Servicebase_workshop - 获取动态对象
2020-01-08 20:14:35,026 [792] DEBUG Sys - select base_Workshop.* from base_Workshop where  id =  ''
2020-01-08 20:14:35,031 [792] ERROR Servicebase_workshop - 获取动态对象失败
System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QuerySingleDynamic() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 155
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass47_0.<GetDynamic>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 59
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:35,034 [792] ERROR Servicebase_workshop - 编辑记录失败
System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetDynamic(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 59
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass34_0.<Edit>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 115
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:14:35,057 [792] ERROR /api/erp/Workshop/edit - System.Data.SqlClient.SqlException (0x80131904): 对象名 'base_Workshop' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.Edit(RequestWrapper formWrapper, RequestWrapper listWrapper, JObject data) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseEdit.cs:行号 68
   在 CallSite.Target(Closure , CallSite , base_workshopService , Object , RequestWrapper , Object )
   在 System.Dynamic.UpdateDelegates.UpdateAndExecute4[T0,T1,T2,T3,TRet](CallSite site, T0 arg0, T1 arg1, T2 arg2, T3 arg3)
   在 ERP.Web.Areas.Erp.Controllers.WorkshopApiController.Edit(Object data) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\WorkshopController.cs:行号 83
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClassf.<GetExecutor>b__9(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:2f6b054d-dba5-4e98-818c-3798b88c0383
Error Number:208,State:1,Class:16
2020-01-08 20:15:36,198 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:36,240 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:36,253 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:36,254 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:36,264 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:36,265 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 20:15:37,236 [2180] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 20:15:41,106 [792] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 20:15:41,567 [6308] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:15:41,727 [792] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 20:15:42,104 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/workshop/Index','/Erp/workshop')
2020-01-08 20:15:44,699 [792] DEBUG Servicebase_workshop - 获取动态列表
2020-01-08 20:15:44,712 [792] DEBUG Erp - select top 20 * from base_Workshop order by id
2020-01-08 20:15:44,726 [792] DEBUG Erp - select count(*) from ( select * from base_Workshop ) tb_temp
2020-01-08 20:15:58,034 [792] DEBUG Servicebase_workshop - 编辑记录
2020-01-08 20:15:58,068 [792] DEBUG Servicebase_workshop - 获取动态对象
2020-01-08 20:15:58,076 [792] DEBUG Erp - select base_Workshop.* from base_Workshop where  id =  ''
2020-01-08 20:15:58,105 [792] DEBUG Erp - insert into base_Workshop([name],[isenable],[remark],[create_username],[create_time]) values('胶印车间','true','aa','超级管理员','2020/1/8 20:15:58')
2020-01-08 20:16:09,427 [792] DEBUG Servicebase_workshop - 编辑记录
2020-01-08 20:16:09,427 [792] DEBUG Servicebase_workshop - 获取动态对象
2020-01-08 20:16:09,448 [792] DEBUG Erp - select base_Workshop.* from base_Workshop where  id =  ''
2020-01-08 20:16:09,449 [792] DEBUG Erp - insert into base_Workshop([name],[isenable],[remark],[create_username],[create_time]) values('模切车间','true','','超级管理员','2020/1/8 20:16:09')
2020-01-08 20:16:12,818 [6408] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/workshop/Index','/Erp/workshop')
2020-01-08 20:16:13,607 [9164] DEBUG Servicebase_workshop - 获取动态列表
2020-01-08 20:16:13,607 [9164] DEBUG Erp - select top 20 * from base_Workshop order by id
2020-01-08 20:16:13,608 [9164] DEBUG Erp - select count(*) from ( select * from base_Workshop ) tb_temp
2020-01-08 20:16:19,529 [5672] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/supplier/Index','/Erp/supplier')
2020-01-08 20:16:19,556 [5672] DEBUG Servicebase_data - 获取动态列表
2020-01-08 20:16:19,557 [5672] DEBUG Erp - select name as value,name as text from base_data where  type =  '客户等级'and isenable =  '1'
2020-01-08 20:16:32,151 [2180] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-08 20:16:32,172 [2180] DEBUG Servicebase_data - 获取动态列表
2020-01-08 20:16:32,172 [2180] DEBUG Erp - select name as value,name as text from base_data where  type =  '单位'and isenable =  '1'
2020-01-08 20:16:32,194 [2180] DEBUG Servicebase_data - 获取动态列表
2020-01-08 20:16:32,194 [2180] DEBUG Erp - select name as value,name as text from base_data where  type =  '物料'and isenable =  '1'
2020-01-08 20:16:34,275 [2480] DEBUG Servicebase_material - 获取动态列表
2020-01-08 20:16:34,276 [2480] DEBUG Erp - select top 20 * from base_material order by id
2020-01-08 20:16:34,313 [2480] DEBUG Erp - select count(*) from ( select * from base_material ) tb_temp
2020-01-08 20:17:13,233 [6308] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-08 20:17:13,274 [6308] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:17:13,275 [6308] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:17:13,286 [6308] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:17:13,286 [6308] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 20:17:15,868 [7848] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 20:17:15,869 [7848] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:17:15,908 [7848] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:17:28,092 [5672] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-08 20:17:28,092 [5672] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:17:28,092 [5672] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:17:28,092 [5672] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:17:28,092 [5672] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 20:17:29,109 [8684] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 20:17:29,109 [8684] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:17:29,116 [8684] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:17:29,777 [4576] DEBUG Servicemms_receive - 获取新主键
2020-01-08 20:17:29,781 [4576] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2020-01-08 20:17:30,010 [8088] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/edit')
2020-01-08 20:17:30,039 [8088] DEBUG Servicemms_receive - 获取实体对象
2020-01-08 20:17:30,041 [8088] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '202001080001'
2020-01-08 20:17:30,048 [8088] DEBUG Servicemms_receive - 获取上一条下一条数据
2020-01-08 20:17:30,092 [8088] DEBUG Servicemms_receive - 获取字段
2020-01-08 20:17:30,095 [8088] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:17:30,101 [8088] DEBUG Servicemms_receive - 获取字段
2020-01-08 20:17:30,101 [8088] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '202001080001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:17:30,107 [8088] DEBUG Servicemms_receive - 获取字段
2020-01-08 20:17:30,108 [8088] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '202001080001'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:17:30,113 [8088] DEBUG Servicemms_receive - 获取字段
2020-01-08 20:17:30,114 [8088] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:17:30,176 [8088] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:17:30,177 [8088] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 20:17:30,180 [8088] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:17:30,180 [8088] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 20:17:30,181 [8088] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:17:30,181 [8088] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 20:17:30,183 [8088] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:17:30,183 [8088] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:17:30,185 [8088] DEBUG Servicesys_code - 获取字段
2020-01-08 20:17:30,186 [8088] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 20:17:30,189 [8088] DEBUG Servicesys_code - 获取字段
2020-01-08 20:17:30,189 [8088] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 20:17:33,128 [4576] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 20:17:33,128 [4576] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001080001' order by A.MaterialCode
2020-01-08 20:17:43,240 [9164] DEBUG Servicemms_materialType - 获取动态列表
2020-01-08 20:17:43,241 [9164] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2020-01-08 20:17:43,331 [4576] DEBUG Servicemms_material - 获取动态列表
2020-01-08 20:17:43,332 [4576] DEBUG Mms - select top 10 A.* from 
    mms_material A
   order by A.MaterialCode
2020-01-08 20:17:43,351 [4576] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   ) tb_temp
2020-01-08 20:25:54,560 [3772] DEBUG Servicemms_materialType - 获取动态列表
2020-01-08 20:25:54,579 [3772] DEBUG Mms - select 
        MaterialTypeName as text,MaterialType as id,ParentCode as pid
     from 
        mms_materialType
     order by MaterialType
2020-01-08 20:25:54,619 [8964] DEBUG Servicemms_material - 获取动态列表
2020-01-08 20:25:54,620 [8964] DEBUG Mms - select top 10 A.* from 
    mms_material A
   order by A.MaterialCode
2020-01-08 20:25:54,635 [8964] DEBUG Mms - select count(*) from ( select A.* from 
    mms_material A
   ) tb_temp
2020-01-08 20:26:05,208 [4260] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/send/Index','/Mms/send')
2020-01-08 20:26:05,284 [4260] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:26:05,284 [4260] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:26:05,297 [4260] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:05,297 [4260] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-08 20:26:05,300 [4260] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:05,301 [4260] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-08 20:26:06,598 [4260] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-08 20:26:06,601 [4260] DEBUG Sys - 
select *
from sys_roleMenuColumnMap 
where MenuCode = '1001'
and RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
2020-01-08 20:26:06,638 [4260] DEBUG Sys - select MenuCode from sys_menu where URL = '/mms/send'
2020-01-08 20:26:06,639 [4260] DEBUG Sys - 
select A.*
from sys_button A
inner join sys_roleMenuButtonMap B on B.MenuCode = '1001' and B.ButtonCode = A.ButtonCode
where RoleCode in (
select RoleCode
from sys_userRoleMap
where userCode = 'super'
union
select A.RoleCode
from sys_organizeRoleMap A
inner join sys_userOrganizeMap B on B.OrganizeCode = A.OrganizeCode
where B.UserCode = 'super'
)
order by ButtonSeq
2020-01-08 20:26:07,386 [3772] DEBUG Servicemms_send - 获取动态列表
2020-01-08 20:26:07,386 [3772] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:26:07,411 [3772] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as PickUnitName
     from 
        mms_send A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants E on E.MerchantsCode=A.PickUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:26:09,271 [6360] DEBUG Servicemms_send - 获取新主键
2020-01-08 20:26:09,272 [6360] DEBUG Mms - select isnull(max(BillNo),0) from mms_send
2020-01-08 20:26:09,361 [7848] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/send/edit')
2020-01-08 20:26:09,381 [7848] DEBUG Servicemms_send - 获取实体对象
2020-01-08 20:26:09,382 [7848] DEBUG Mms - select mms_send.* from mms_send where  BillNo =  '202001080001'
2020-01-08 20:26:09,391 [7848] DEBUG Servicemms_send - 获取上一条下一条数据
2020-01-08 20:26:09,393 [7848] DEBUG Servicemms_send - 获取字段
2020-01-08 20:26:09,393 [7848] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:26:09,399 [7848] DEBUG Servicemms_send - 获取字段
2020-01-08 20:26:09,399 [7848] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo < '202001080001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:26:09,412 [7848] DEBUG Servicemms_send - 获取字段
2020-01-08 20:26:09,412 [7848] DEBUG Mms - select top 1 BillNo from mms_send where  BillNo >  '202001080001'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:26:09,417 [7848] DEBUG Servicemms_send - 获取字段
2020-01-08 20:26:09,418 [7848] DEBUG Mms - select top 1 BillNo from mms_send where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:26:09,470 [7848] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:09,471 [7848] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'Pricing'
2020-01-08 20:26:09,472 [7848] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:09,472 [7848] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'MaterialUse'
2020-01-08 20:26:09,473 [7848] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:09,473 [7848] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 20:26:09,474 [7848] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:26:09,474 [7848] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:26:09,475 [7848] DEBUG Servicesys_code - 获取字段
2020-01-08 20:26:09,475 [7848] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'Pricing'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 20:26:12,001 [9964] DEBUG Servicemms_send - 获取动态列表
2020-01-08 20:26:12,002 [9964] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_sendDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001080001' order by A.MaterialCode
2020-01-08 20:26:17,227 [8964] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2020-01-08 20:26:17,246 [8964] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:26:17,246 [8964] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:26:19,360 [6360] DEBUG Servicemms_refund - 获取动态列表
2020-01-08 20:26:19,360 [6360] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:26:19,392 [6360] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:26:23,915 [792] DEBUG Servicemms_refund - 获取新主键
2020-01-08 20:26:23,915 [792] DEBUG Mms - select isnull(max(BillNo),0) from mms_refund
2020-01-08 20:26:24,006 [8964] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/edit')
2020-01-08 20:26:24,038 [8964] DEBUG Servicemms_refund - 获取实体对象
2020-01-08 20:26:24,039 [8964] DEBUG Mms - select mms_refund.* from mms_refund where  BillNo =  '202001080001'
2020-01-08 20:26:24,056 [8964] DEBUG Servicemms_refund - 获取上一条下一条数据
2020-01-08 20:26:24,059 [8964] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:26:24,060 [8964] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:26:24,085 [8964] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:26:24,085 [8964] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo < '202001080001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:26:24,090 [8964] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:26:24,090 [8964] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo >  '202001080001'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:26:24,097 [8964] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:26:24,097 [8964] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:26:24,142 [8964] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:26:24,142 [8964] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 20:26:24,143 [8964] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:26:24,143 [8964] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:26:26,178 [2180] DEBUG Servicemms_refund - 获取动态列表
2020-01-08 20:26:26,178 [2180] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.UnitPrice as SrcUnitPrice,C.Num as SrcNum
     from 
        mms_refundDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
        left join mms_sendDetail C on C.BillNo =  A.SrcBillNo and C.RowId = A.SrcRowId
     where  A.BillNo =  '202001080001' order by A.MaterialCode
2020-01-08 20:27:08,871 [2180] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2020-01-08 20:27:08,875 [2180] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:27:08,875 [2180] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:27:09,892 [792] DEBUG Servicemms_refund - 获取动态列表
2020-01-08 20:27:09,893 [792] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:27:09,896 [792] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:27:33,666 [10232] DEBUG Servicemms_refund - 获取新主键
2020-01-08 20:27:33,667 [10232] DEBUG Mms - select isnull(max(BillNo),0) from mms_refund
2020-01-08 20:27:33,829 [2180] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/edit')
2020-01-08 20:27:33,834 [2180] DEBUG Servicemms_refund - 获取实体对象
2020-01-08 20:27:33,834 [2180] DEBUG Mms - select mms_refund.* from mms_refund where  BillNo =  '202001080002'
2020-01-08 20:27:33,835 [2180] DEBUG Servicemms_refund - 获取上一条下一条数据
2020-01-08 20:27:33,835 [2180] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:27:33,835 [2180] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:27:33,836 [2180] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:27:33,836 [2180] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo < '202001080002'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:27:33,840 [2180] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:27:33,840 [2180] DEBUG Mms - select top 1 BillNo from mms_refund where  BillNo >  '202001080002'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 20:27:33,843 [2180] DEBUG Servicemms_refund - 获取字段
2020-01-08 20:27:33,843 [2180] DEBUG Mms - select top 1 BillNo from mms_refund where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 20:27:33,844 [2180] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:27:33,844 [2180] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 20:27:33,845 [2180] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:27:33,846 [2180] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:27:35,919 [9584] DEBUG Servicemms_refund - 获取动态列表
2020-01-08 20:27:35,920 [9584] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material,C.UnitPrice as SrcUnitPrice,C.Num as SrcNum
     from 
        mms_refundDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
        left join mms_sendDetail C on C.BillNo =  A.SrcBillNo and C.RowId = A.SrcRowId
     where  A.BillNo =  '202001080002' order by A.MaterialCode
2020-01-08 20:27:55,311 [6308] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/refund/Index','/Mms/refund')
2020-01-08 20:27:55,320 [6308] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:27:55,320 [6308] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:27:56,450 [9584] DEBUG Servicemms_refund - 获取动态列表
2020-01-08 20:27:56,450 [9584] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:27:56,452 [9584] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName,E.MerchantsName as RefundUnitName
     from 
        mms_refund A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.RefundUnit
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 20:28:02,504 [3772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-08 20:28:02,508 [3772] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 20:28:02,508 [3772] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 20:28:02,509 [3772] DEBUG Servicesys_code - 获取动态列表
2020-01-08 20:28:02,509 [3772] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 20:28:03,895 [9964] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 20:28:03,895 [9964] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 20:28:03,899 [9964] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 21:01:22,247 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:22,291 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:22,327 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:22,328 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:22,334 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:22,335 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,819 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,838 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,844 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,845 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,850 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:52,851 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:01:53,268 [5172] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:02:12,761 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:12,790 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:12,799 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:12,799 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:12,807 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:12,808 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:02:13,656 [9972] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:02:14,646 [8776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:02:19,687 [10156] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:02:19,698 [10156] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:03:30,039 [9540] DEBUG Servicesys_menu - 编辑记录
2020-01-08 21:03:30,083 [9540] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:03:30,091 [9540] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  'a3a0edea-acf8-4a25-a384-f44eb1613f06'
2020-01-08 21:03:30,142 [9540] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('施工单管理','4000','','icon-calendar_edit','/erp/ErpConstruction','true','true','2','超级管理员','2020/1/8 21:03:30','超级管理员','2020/1/8 21:03:30')
2020-01-08 21:03:30,192 [9540] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"a3a0edea-acf8-4a25-a384-f44eb1613f06","MenuName":"施工单管理","MenuCode":"4000","ParentCode":"","IconClass":"icon-calendar_edit","URL":"/erp/ErpConstruction","IsVisible":"true","IsEnable":"true","MenuSeq":"2"}],"updated":[],"_changed":true}}','2020/1/8 21:03:30')
2020-01-08 21:03:30,460 [7656] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:03:30,460 [7656] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:04:02,042 [8896] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:04:02,049 [8896] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:04:02,049 [8896] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:04:02,051 [8896] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:04:02,051 [8896] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:04:03,966 [9540] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:04:03,969 [9540] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:04:05,754 [9972] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-08 21:04:05,759 [2856] DEBUG Servicesys_permission - 获取动态列表
2020-01-08 21:04:05,760 [2856] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-08 21:04:05,760 [9972] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-08 21:04:06,035 [9972] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-08 21:04:17,831 [5172] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-08 21:04:17,838 [5172] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-08 21:04:17,840 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-08 21:04:17,841 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-08 21:04:17,841 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-08 21:04:17,842 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-08 21:04:17,843 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-08 21:04:17,844 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-08 21:04:17,845 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-08 21:04:17,846 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-08 21:04:17,847 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-08 21:04:17,848 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-08 21:04:17,849 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-08 21:04:17,850 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-08 21:04:17,851 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-08 21:04:17,852 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-08 21:04:17,852 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-08 21:04:17,853 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-08 21:04:17,856 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-08 21:04:17,857 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-08 21:04:17,858 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-08 21:04:17,859 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-08 21:04:17,860 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-08 21:04:17,861 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-08 21:04:17,862 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-08 21:04:17,863 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-08 21:04:17,864 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-08 21:04:17,864 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-08 21:04:17,865 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-08 21:04:17,866 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-08 21:04:17,867 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-08 21:04:17,868 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4000')
2020-01-08 21:04:17,869 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-08 21:04:17,870 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-08 21:04:17,871 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-08 21:04:17,871 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-08 21:04:17,872 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-08 21:04:17,873 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-08 21:04:17,874 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-08 21:04:17,875 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-08 21:04:17,876 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-08 21:04:17,877 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-08 21:04:17,877 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-08 21:04:17,878 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-08 21:04:17,879 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-08 21:04:17,880 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-08 21:04:17,881 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-08 21:04:17,882 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-08 21:04:17,883 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-08 21:04:17,884 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-08 21:04:17,884 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-08 21:04:17,885 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-08 21:04:17,886 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-08 21:04:17,887 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-08 21:04:17,888 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-08 21:04:17,889 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-08 21:04:17,890 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-08 21:04:17,891 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-08 21:04:17,891 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-08 21:04:17,892 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-08 21:04:17,893 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-08 21:04:17,894 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-08 21:04:17,895 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-08 21:04:17,896 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-08 21:04:17,897 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-08 21:04:17,898 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-08 21:04:17,898 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-08 21:04:17,899 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10010')
2020-01-08 21:04:17,900 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10012')
2020-01-08 21:04:17,901 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10002')
2020-01-08 21:04:17,902 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10003')
2020-01-08 21:04:17,903 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10004')
2020-01-08 21:04:17,904 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10005')
2020-01-08 21:04:17,905 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10006')
2020-01-08 21:04:17,905 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10007')
2020-01-08 21:04:17,906 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10008')
2020-01-08 21:04:17,908 [5172] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10009')
2020-01-08 21:04:17,914 [5172] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-08 21:04:17,916 [5172] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-08 21:04:17,917 [5172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-08 21:04:17,918 [5172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-08 21:04:17,919 [5172] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-08 21:04:17,924 [5172] DEBUG Servicesys_role - 修改角色数据权限
2020-01-08 21:04:17,926 [5172] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-08 21:04:17,931 [5172] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-08 21:04:17,936 [5172] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-08 21:04:17,947 [5172] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-08 21:04:21,310 [5384] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:04:25,471 [9972] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:04:26,431 [9540] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:04:26,434 [9540] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:04:26,435 [9540] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:04:26,436 [9540] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:04:26,437 [9540] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:04:27,006 [5172] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:04:27,007 [5172] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:04:35,464 [5384] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/material/Index','/Erp/material')
2020-01-08 21:04:35,501 [5384] DEBUG Servicebase_data - 获取动态列表
2020-01-08 21:04:35,502 [5384] DEBUG Erp - select name as value,name as text from base_data where  type =  '单位'and isenable =  '1'
2020-01-08 21:04:35,528 [5384] DEBUG Servicebase_data - 获取动态列表
2020-01-08 21:04:35,529 [5384] DEBUG Erp - select name as value,name as text from base_data where  type =  '物料'and isenable =  '1'
2020-01-08 21:04:37,781 [7720] DEBUG Servicebase_material - 获取动态列表
2020-01-08 21:04:37,782 [7720] DEBUG Erp - select top 20 * from base_material order by id
2020-01-08 21:04:37,806 [7720] DEBUG Erp - select count(*) from ( select * from base_material ) tb_temp
2020-01-08 21:04:38,012 [8776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:04:38,395 [8896] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:04:38,395 [8896] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:05:49,138 [7720] DEBUG Servicesys_menu - 编辑记录
2020-01-08 21:05:49,138 [7720] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:05:49,139 [7720] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '1c4ff4bf-c003-4d62-9895-c60543f30925'
2020-01-08 21:05:49,141 [7720] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('施工单','4002','4000','icon-award_star_bronze_3','/erp/ErpConstruction','true','true','2','超级管理员','2020/1/8 21:05:49','超级管理员','2020/1/8 21:05:49')
2020-01-08 21:05:49,147 [7720] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"1c4ff4bf-c003-4d62-9895-c60543f30925","MenuName":"施工单","MenuCode":"4002","ParentCode":"4000","IconClass":"icon-award_star_bronze_3","URL":"/erp/ErpConstruction","IsVisible":"true","IsEnable":"true","MenuSeq":"2"}],"updated":[],"_changed":true}}','2020/1/8 21:05:49')
2020-01-08 21:05:49,414 [5384] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:05:49,415 [5384] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:05:50,912 [2856] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:05:50,915 [2856] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:05:50,916 [2856] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:05:50,916 [2856] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:05:50,916 [2856] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:05:51,486 [8776] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:05:51,487 [8776] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:05:54,041 [10204] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-08 21:05:54,044 [10204] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-08 21:05:54,132 [7720] DEBUG Servicesys_permission - 获取动态列表
2020-01-08 21:05:54,132 [7720] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-08 21:05:54,179 [10204] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-08 21:05:57,792 [5384] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-08 21:05:57,793 [5384] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-08 21:05:57,810 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-08 21:05:57,822 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-08 21:05:57,824 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-08 21:05:57,825 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-08 21:05:57,826 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-08 21:05:57,826 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-08 21:05:57,827 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-08 21:05:57,828 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-08 21:05:57,829 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-08 21:05:57,829 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-08 21:05:57,830 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-08 21:05:57,831 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-08 21:05:57,831 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-08 21:05:57,832 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-08 21:05:57,833 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-08 21:05:57,834 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-08 21:05:57,835 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-08 21:05:57,836 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-08 21:05:57,837 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-08 21:05:57,838 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-08 21:05:57,838 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-08 21:05:57,839 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-08 21:05:57,840 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-08 21:05:57,841 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-08 21:05:57,842 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-08 21:05:57,843 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-08 21:05:57,844 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-08 21:05:57,845 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-08 21:05:57,845 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-08 21:05:57,847 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4000')
2020-01-08 21:05:57,848 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4002')
2020-01-08 21:05:57,848 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-08 21:05:57,849 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-08 21:05:57,850 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-08 21:05:57,851 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-08 21:05:57,852 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-08 21:05:57,853 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-08 21:05:57,854 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-08 21:05:57,855 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-08 21:05:57,856 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-08 21:05:57,856 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-08 21:05:57,857 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-08 21:05:57,858 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-08 21:05:57,859 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-08 21:05:57,860 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-08 21:05:57,861 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-08 21:05:57,862 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-08 21:05:57,863 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-08 21:05:57,864 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-08 21:05:57,864 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-08 21:05:57,865 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-08 21:05:57,866 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-08 21:05:57,867 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-08 21:05:57,868 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-08 21:05:57,869 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-08 21:05:57,870 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-08 21:05:57,870 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-08 21:05:57,871 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-08 21:05:57,872 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-08 21:05:57,875 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-08 21:05:57,876 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-08 21:05:57,877 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-08 21:05:57,877 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-08 21:05:57,879 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-08 21:05:57,880 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-08 21:05:57,881 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-08 21:05:57,882 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10010')
2020-01-08 21:05:57,883 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10012')
2020-01-08 21:05:57,883 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10002')
2020-01-08 21:05:57,884 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10003')
2020-01-08 21:05:57,885 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10004')
2020-01-08 21:05:57,886 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10005')
2020-01-08 21:05:57,887 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10006')
2020-01-08 21:05:57,888 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10007')
2020-01-08 21:05:57,889 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10008')
2020-01-08 21:05:57,889 [5384] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10009')
2020-01-08 21:05:57,892 [5384] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-08 21:05:57,892 [5384] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-08 21:05:57,893 [5384] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-08 21:05:57,894 [5384] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-08 21:05:57,895 [5384] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-08 21:05:57,897 [5384] DEBUG Servicesys_role - 修改角色数据权限
2020-01-08 21:05:57,898 [5384] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-08 21:05:57,899 [5384] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-08 21:05:57,899 [5384] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-08 21:05:57,901 [5384] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-08 21:06:00,243 [5172] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:06:00,560 [10156] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:06:01,502 [10204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:06:01,506 [10204] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:06:01,506 [10204] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:06:01,507 [10204] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:06:01,507 [10204] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:06:02,182 [5172] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:06:02,182 [5172] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:06:03,874 [10204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:06:03,885 [10204] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:06:03,886 [10204] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:06:03,888 [10204] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:06:03,888 [10204] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:07:30,481 [2856] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:07:30,946 [5172] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:07:31,976 [7720] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:07:31,978 [7720] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:07:31,979 [7720] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:07:31,979 [7720] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:07:31,980 [7720] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:07:32,024 [8776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:07:32,027 [8776] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:07:32,028 [8776] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:07:32,028 [8776] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:07:32,028 [8776] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:09:24,278 [7720] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:09:24,817 [5464] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:09:25,911 [2856] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:09:25,915 [2856] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:09:25,915 [2856] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:09:25,916 [2856] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:09:25,916 [2856] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:09:25,952 [10204] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:09:25,957 [10204] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:09:25,958 [10204] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:09:25,958 [10204] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:09:25,959 [10204] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:09:58,561 [5464] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:09:59,338 [9928] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:10:00,840 [7720] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:10:00,843 [7720] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:10:00,843 [7720] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:10:00,844 [7720] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:10:00,844 [7720] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:10:00,874 [5888] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:10:00,877 [5888] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:10:00,877 [5888] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:10:00,877 [5888] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:10:00,878 [5888] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:10:13,473 [10156] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:10:13,496 [10156] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:10:13,496 [10156] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:10:13,497 [10156] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:10:13,498 [10156] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:11:22,971 [7720] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:11:23,745 [10156] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:11:25,065 [8776] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:11:25,071 [8776] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:11:25,071 [8776] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:11:25,074 [8776] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:11:25,075 [8776] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:11:25,115 [5464] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:11:25,123 [5464] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:11:25,123 [5464] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:11:25,124 [5464] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:11:25,124 [5464] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:17:46,967 [5572] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:47,012 [5572] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:47,025 [5572] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:47,026 [5572] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:47,037 [5572] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:47,038 [5572] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:17:48,126 [10128] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:17:53,077 [10804] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:20:25,592 [5572] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:25,635 [5572] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:25,648 [5572] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:25,649 [5572] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:25,661 [5572] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:25,662 [5572] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:20:26,664 [10792] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:20:31,344 [5384] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:20:36,677 [10792] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:20:36,695 [10792] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:20:36,714 [10792] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:20:36,720 [10792] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:20:36,720 [10792] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:20:38,736 [5384] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:20:38,737 [5384] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:20:38,753 [5384] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:20:39,785 [9928] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:20:39,790 [9928] DEBUG Erp - select isnull(max(BillNo),0) from erp_construction
2020-01-08 21:20:39,801 [9928] ERROR Serviceerp_construction - 获取新主键失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Core.NewKey.dateplus(IDbContext db, String table, String field, String datestringFormat, Int32 numberLength) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\NewKey.cs:行号 50
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass13_0.<GetNewKey>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 114
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:f7a1710e-c5f4-44f1-89aa-70033e4dbfcc
Error Number:207,State:1,Class:16
2020-01-08 21:20:39,876 [9928] ERROR /api/erp/ErpConstruction/getnewbillno - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetNewKey(String field, String rule, Int32 qty, ParamQuery pQuery) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 101
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetNewBillNo() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 55
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:f7a1710e-c5f4-44f1-89aa-70033e4dbfcc
Error Number:207,State:1,Class:16
2020-01-08 21:21:59,064 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:21:59,110 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:21:59,145 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:21:59,159 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:21:59,175 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:21:59,176 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:22:00,078 [7656] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:22:06,299 [10792] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:24:49,503 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,514 [9060] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,518 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,519 [9060] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,521 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,522 [9060] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:24:49,772 [10772] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:24:51,647 [11088] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:25:01,827 [10736] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:25:01,853 [10736] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:25:01,882 [10736] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:25:01,891 [10736] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:25:01,891 [10736] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:25:04,582 [11088] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:25:04,583 [11088] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:25:04,598 [11088] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:25:06,823 [9612] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:25:06,827 [9612] DEBUG Erp - select isnull(max(BillNo),0) from erp_construction
2020-01-08 21:25:06,842 [9612] ERROR Serviceerp_construction - 获取新主键失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Core.NewKey.dateplus(IDbContext db, String table, String field, String datestringFormat, Int32 numberLength) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\NewKey.cs:行号 50
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass13_0.<GetNewKey>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 114
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:25:06,913 [9612] ERROR /api/erp/ErpConstruction/getnewbillno - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetNewKey(String field, String rule, Int32 qty, ParamQuery pQuery) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 101
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetNewBillNo() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 55
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:29:01,285 [1348] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:29:01,914 [5008] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:29:02,935 [9884] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:02,937 [9884] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:02,938 [9884] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:02,938 [9884] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:02,938 [9884] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:02,969 [5384] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:02,972 [5384] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:02,972 [5384] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:02,973 [5384] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:02,973 [5384] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:05,498 [5384] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:05,498 [5384] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:05,499 [5384] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:05,627 [10772] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:05,628 [10772] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:05,632 [10772] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:05,981 [9612] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:29:05,981 [9612] DEBUG Erp - select isnull(max(BillNo),0) from erp_construction
2020-01-08 21:29:05,982 [9612] ERROR Serviceerp_construction - 获取新主键失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Core.NewKey.dateplus(IDbContext db, String table, String field, String datestringFormat, Int32 numberLength) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\NewKey.cs:行号 50
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass13_0.<GetNewKey>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 114
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:29:05,990 [9612] ERROR /api/erp/ErpConstruction/getnewbillno - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetNewKey(String field, String rule, Int32 qty, ParamQuery pQuery) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 101
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetNewBillNo() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 55
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:29:18,511 [1348] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:29:18,900 [9884] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:29:19,671 [10772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:19,673 [10772] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:19,673 [10772] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:19,674 [10772] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:19,674 [10772] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:19,699 [5384] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:19,702 [5384] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:19,702 [5384] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:19,702 [5384] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:19,702 [5384] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:23,833 [9884] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:23,834 [9884] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:23,835 [9884] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:23,953 [5008] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:23,953 [5008] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:23,954 [5008] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:24,755 [9928] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:29:24,756 [9928] DEBUG Erp - select isnull(max(BillNo),0) from erp_construction
2020-01-08 21:29:24,768 [9928] ERROR Serviceerp_construction - 获取新主键失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Core.NewKey.dateplus(IDbContext db, String table, String field, String datestringFormat, Int32 numberLength) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\NewKey.cs:行号 50
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass13_0.<GetNewKey>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 114
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:29:24,784 [9928] ERROR /api/erp/ErpConstruction/getnewbillno - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetNewKey(String field, String rule, Int32 qty, ParamQuery pQuery) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 101
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetNewBillNo() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 55
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:5f27080c-3943-4c79-adaa-a71b1a0f0a6b
Error Number:207,State:1,Class:16
2020-01-08 21:29:40,234 [7344] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:29:40,540 [5516] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:29:41,211 [10772] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:41,214 [10772] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:41,214 [10772] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:41,214 [10772] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:41,215 [10772] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:41,238 [1348] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:41,240 [1348] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:41,240 [1348] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:41,241 [1348] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:41,241 [1348] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:29:42,536 [11088] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:42,536 [11088] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:42,536 [11088] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:42,645 [9884] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:29:42,645 [9884] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:29:42,645 [9884] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:29:43,313 [9928] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:29:43,325 [9928] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:29:43,325 [9928] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:29:43,326 [9928] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:29:43,327 [9928] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:30:12,892 [9200] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:30:13,430 [5516] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:30:14,513 [1348] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:30:14,516 [1348] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:30:14,516 [1348] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:30:14,516 [1348] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:30:14,516 [1348] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:30:14,551 [11088] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:30:14,554 [11088] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:30:14,554 [11088] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:30:14,556 [11088] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:30:14,556 [11088] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:30:16,135 [9928] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:30:16,135 [9928] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:30:16,136 [9928] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:30:16,275 [5008] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:30:16,276 [5008] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:30:16,276 [5008] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:30:17,284 [5648] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:30:17,288 [5648] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:30:17,288 [5648] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:30:17,289 [5648] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:30:17,289 [5648] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:30:37,297 [5516] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:30:37,300 [5516] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:30:37,300 [5516] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:30:37,300 [5516] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:30:37,301 [5516] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:31:08,770 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:08,804 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:08,813 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:08,813 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:08,821 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:08,822 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:31:38,596 [10904] DEBUG Servicesys_user - 获取实体对象
2020-01-08 21:31:38,626 [10904] DEBUG Sys - select sys_user.* from sys_user where  UserCode =  'super'and Password =  '1234'and IsEnable =  'True'
2020-01-08 21:31:38,758 [10904] DEBUG Sys - 
update sys_user
set LoginCount = isnull(LoginCount,0) + 1
   ,LastLoginDate = getdate()
where UserCode = 'super' 
2020-01-08 21:31:38,828 [10904] DEBUG Sys - insert into sys_loginHistory([UserCode],[UserName],[HostName],[HostIP],[LoginCity],[LoginDate]) values('super','超级管理员','4S6DBKLDWJUEQVW','localhost','上海市','2020/1/8 21:31:38')
2020-01-08 21:31:38,831 [10904] DEBUG Servicemms_project - 获取实体对象
2020-01-08 21:31:38,831 [10904] DEBUG Mms - select mms_project.* from mms_project where  ProjectCode =  '201306030001'
2020-01-08 21:31:38,904 [8952] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:31:42,560 [8156] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:32:07,156 [7220] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:32:07,260 [7220] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:32:07,263 [7220] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:32:07,274 [7220] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:32:07,275 [7220] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:32:14,113 [9192] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:32:14,114 [9192] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:32:14,141 [9192] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:32:15,887 [9192] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:32:15,899 [9192] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:32:15,900 [9192] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:32:15,954 [9192] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:32:15,955 [9192] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:32:33,671 [9092] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:32:34,282 [7220] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:32:39,575 [7908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:32:39,579 [7908] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:32:39,580 [7908] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:32:39,581 [7908] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:32:39,581 [7908] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:32:40,654 [10904] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:32:40,655 [10904] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:32:40,656 [10904] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:32:43,568 [9092] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:32:43,636 [9092] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:32:43,636 [9092] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:32:43,707 [9092] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:32:43,707 [9092] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:33:00,939 [8952] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:33:00,949 [8952] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:33:00,949 [8952] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:33:00,953 [8952] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:33:00,953 [8952] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:33:03,816 [3924] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:33:03,816 [3924] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:33:03,817 [3924] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:33:46,186 [7220] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:33:46,193 [7220] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:33:46,193 [7220] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:33:46,195 [7220] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:33:46,196 [7220] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:34:58,134 [7220] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:34:59,577 [10904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:35:00,428 [3924] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:35:00,430 [3924] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:35:00,430 [3924] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:35:00,431 [3924] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:35:00,431 [3924] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:35:00,451 [6428] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:35:00,453 [6428] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:35:00,453 [6428] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:35:00,454 [6428] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:35:00,454 [6428] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:35:02,392 [5308] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:35:02,393 [5308] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:35:02,396 [5308] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:35:02,529 [9092] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:35:02,529 [9092] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:35:02,530 [9092] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:35:16,519 [7220] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:35:16,521 [7220] DEBUG Erp - select isnull(max(BillNo),0) from erp_construction
2020-01-08 21:35:16,526 [7220] ERROR Serviceerp_construction - 获取新主键失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Core.NewKey.dateplus(IDbContext db, String table, String field, String datestringFormat, Int32 numberLength) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Core\NewKey.cs:行号 50
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass13_0.<GetNewKey>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 114
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:0e5118d8-7185-4ba4-b89c-c1039ccb223e
Error Number:207,State:1,Class:16
2020-01-08 21:35:16,582 [7220] ERROR /api/erp/ErpConstruction/getnewbillno - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetNewKey(String field, String rule, Int32 qty, ParamQuery pQuery) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 101
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetNewBillNo() 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 55
   在 lambda_method(Closure , Object , Object[] )
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)
   在 System.Web.Http.Controllers.ReflectedHttpActionDescriptor.<>c__DisplayClass5.<ExecuteAsync>b__4()
   在 System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)
ClientConnectionId:0e5118d8-7185-4ba4-b89c-c1039ccb223e
Error Number:207,State:1,Class:16
2020-01-08 21:36:22,838 [3184] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:22,867 [3184] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:22,876 [3184] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:22,876 [3184] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:22,884 [3184] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:22,884 [3184] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:36:23,580 [5308] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:36:27,806 [6104] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:36:35,206 [3924] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:36:35,251 [3924] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:36:35,271 [3924] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:36:35,281 [3924] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:36:35,282 [3924] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:36:37,573 [5308] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:36:37,573 [5308] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:36:37,586 [5308] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:36:40,324 [5308] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:36:40,328 [5308] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:36:40,588 [9092] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:37:05,901 [6428] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:37:07,571 [6104] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:37:07,572 [6104] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:37:26,361 [9092] DEBUG Sys - 
select A.*,
       case when B.ID is null then 0 else 1 end as Selected
from sys_button A
left join sys_menuButtonMap B on B.MenuCode = '1002' and B.ButtonCode = A.ButtonCode
order by ButtonSeq
2020-01-08 21:37:35,737 [7908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-08 21:37:35,746 [7908] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:37:35,746 [7908] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:37:35,748 [7908] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:37:35,748 [7908] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:37:38,718 [9092] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 21:37:38,719 [9092] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 21:37:38,737 [9092] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 21:37:39,308 [7220] DEBUG Servicemms_receive - 获取新主键
2020-01-08 21:37:39,309 [7220] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2020-01-08 21:37:39,392 [9420] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/edit')
2020-01-08 21:37:39,407 [9420] DEBUG Servicemms_receive - 获取实体对象
2020-01-08 21:37:39,410 [9420] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '202001080001'
2020-01-08 21:37:39,413 [9420] DEBUG Servicemms_receive - 获取上一条下一条数据
2020-01-08 21:37:39,460 [9420] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:37:39,463 [9420] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 21:37:39,467 [9420] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:37:39,467 [9420] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '202001080001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 21:37:39,471 [9420] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:37:39,471 [9420] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '202001080001'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 21:37:39,474 [9420] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:37:39,474 [9420] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 21:37:39,534 [9420] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:37:39,535 [9420] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:37:39,536 [9420] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:37:39,536 [9420] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:37:39,537 [9420] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:37:39,537 [9420] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:37:39,538 [9420] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:37:39,539 [9420] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:37:39,541 [9420] DEBUG Servicesys_code - 获取字段
2020-01-08 21:37:39,541 [9420] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:37:39,542 [9420] DEBUG Servicesys_code - 获取字段
2020-01-08 21:37:39,542 [9420] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:37:42,029 [10904] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 21:37:42,030 [10904] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001080001' order by A.MaterialCode
2020-01-08 21:38:17,476 [7220] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:38:17,483 [7220] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:38:17,483 [7220] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:38:17,484 [7220] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:38:17,484 [7220] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:38:18,480 [1112] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:38:18,481 [1112] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:38:18,482 [1112] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:38:22,632 [8396] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:38:23,146 [6104] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:38:23,146 [6104] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:39:58,536 [7908] DEBUG Servicesys_menu - 编辑记录
2020-01-08 21:39:58,564 [7908] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:39:58,570 [7908] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  'a54fe299-845e-4340-9f5b-d6ba6b93e982'
2020-01-08 21:39:58,597 [7908] DEBUG Sys - insert into 
        sys_menu
    ([MenuName],[MenuCode],[ParentCode],[IconClass],[URL],[IsVisible],[IsEnable],[MenuSeq],[UpdatePerson],[UpdateDate],[CreatePerson],[CreateDate]) values('施工单编辑','4000201','4000','','/erp/erpconstruction/edit','false','true','10','超级管理员','2020/1/8 21:39:58','超级管理员','2020/1/8 21:39:58')
2020-01-08 21:39:58,654 [7908] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[{"_id":"a54fe299-845e-4340-9f5b-d6ba6b93e982","MenuName":"施工单编辑","MenuCode":"4000201","ParentCode":"4000","IconClass":"","URL":"/erp/erpconstruction/edit","IsVisible":"false","IsEnable":"true","MenuSeq":"10"}],"updated":[],"_changed":true}}','2020/1/8 21:39:58')
2020-01-08 21:39:58,934 [10904] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:39:58,934 [10904] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:40:03,028 [6428] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:40:03,033 [6428] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:40:03,034 [6428] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:40:03,036 [6428] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:40:03,036 [6428] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:40:05,073 [7908] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:40:05,076 [7908] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:40:07,616 [1112] DEBUG Sys - select * from sys_button order by ButtonSeq
2020-01-08 21:40:07,624 [1112] DEBUG Sys - select A.MenuName,A.MenuCode,A.ParentCode,A.IconClass as iconCls,B.MenuName as ParentName,(select 1 from sys_roleMenuMap tb_role where tb_role.RoleCode='super' and tb_role.MenuCode=A.MenuCode) as checked,(
select case when max(tb1_add.ID) is null then -1 
            when max(tb2_add.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_add
left join sys_roleMenuButtonMap AS tb2_add ON tb2_add.MenuCode=tb1_add.MenuCode AND tb2_add.ButtonCode=tb1_add.ButtonCode AND tb2_add.RoleCode='super'
where tb1_add.MenuCode = A.MenuCode and  tb1_add.ButtonCode = 'add'  
)as 'btn_add' ,(
select case when max(tb1_browse.ID) is null then -1 
            when max(tb2_browse.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_browse
left join sys_roleMenuButtonMap AS tb2_browse ON tb2_browse.MenuCode=tb1_browse.MenuCode AND tb2_browse.ButtonCode=tb1_browse.ButtonCode AND tb2_browse.RoleCode='super'
where tb1_browse.MenuCode = A.MenuCode and  tb1_browse.ButtonCode = 'browse'  
)as 'btn_browse' ,(
select case when max(tb1_edit.ID) is null then -1 
            when max(tb2_edit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_edit
left join sys_roleMenuButtonMap AS tb2_edit ON tb2_edit.MenuCode=tb1_edit.MenuCode AND tb2_edit.ButtonCode=tb1_edit.ButtonCode AND tb2_edit.RoleCode='super'
where tb1_edit.MenuCode = A.MenuCode and  tb1_edit.ButtonCode = 'edit'  
)as 'btn_edit' ,(
select case when max(tb1_delete.ID) is null then -1 
            when max(tb2_delete.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_delete
left join sys_roleMenuButtonMap AS tb2_delete ON tb2_delete.MenuCode=tb1_delete.MenuCode AND tb2_delete.ButtonCode=tb1_delete.ButtonCode AND tb2_delete.RoleCode='super'
where tb1_delete.MenuCode = A.MenuCode and  tb1_delete.ButtonCode = 'delete'  
)as 'btn_delete' ,(
select case when max(tb1_search.ID) is null then -1 
            when max(tb2_search.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_search
left join sys_roleMenuButtonMap AS tb2_search ON tb2_search.MenuCode=tb1_search.MenuCode AND tb2_search.ButtonCode=tb1_search.ButtonCode AND tb2_search.RoleCode='super'
where tb1_search.MenuCode = A.MenuCode and  tb1_search.ButtonCode = 'search'  
)as 'btn_search' ,(
select case when max(tb1_refresh.ID) is null then -1 
            when max(tb2_refresh.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_refresh
left join sys_roleMenuButtonMap AS tb2_refresh ON tb2_refresh.MenuCode=tb1_refresh.MenuCode AND tb2_refresh.ButtonCode=tb1_refresh.ButtonCode AND tb2_refresh.RoleCode='super'
where tb1_refresh.MenuCode = A.MenuCode and  tb1_refresh.ButtonCode = 'refresh'  
)as 'btn_refresh' ,(
select case when max(tb1_export.ID) is null then -1 
            when max(tb2_export.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_export
left join sys_roleMenuButtonMap AS tb2_export ON tb2_export.MenuCode=tb1_export.MenuCode AND tb2_export.ButtonCode=tb1_export.ButtonCode AND tb2_export.RoleCode='super'
where tb1_export.MenuCode = A.MenuCode and  tb1_export.ButtonCode = 'export'  
)as 'btn_export' ,(
select case when max(tb1_download.ID) is null then -1 
            when max(tb2_download.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_download
left join sys_roleMenuButtonMap AS tb2_download ON tb2_download.MenuCode=tb1_download.MenuCode AND tb2_download.ButtonCode=tb1_download.ButtonCode AND tb2_download.RoleCode='super'
where tb1_download.MenuCode = A.MenuCode and  tb1_download.ButtonCode = 'download'  
)as 'btn_download' ,(
select case when max(tb1_print.ID) is null then -1 
            when max(tb2_print.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_print
left join sys_roleMenuButtonMap AS tb2_print ON tb2_print.MenuCode=tb1_print.MenuCode AND tb2_print.ButtonCode=tb1_print.ButtonCode AND tb2_print.RoleCode='super'
where tb1_print.MenuCode = A.MenuCode and  tb1_print.ButtonCode = 'print'  
)as 'btn_print' ,(
select case when max(tb1_accredit.ID) is null then -1 
            when max(tb2_accredit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_accredit
left join sys_roleMenuButtonMap AS tb2_accredit ON tb2_accredit.MenuCode=tb1_accredit.MenuCode AND tb2_accredit.ButtonCode=tb1_accredit.ButtonCode AND tb2_accredit.RoleCode='super'
where tb1_accredit.MenuCode = A.MenuCode and  tb1_accredit.ButtonCode = 'accredit'  
)as 'btn_accredit' ,(
select case when max(tb1_audit.ID) is null then -1 
            when max(tb2_audit.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_audit
left join sys_roleMenuButtonMap AS tb2_audit ON tb2_audit.MenuCode=tb1_audit.MenuCode AND tb2_audit.ButtonCode=tb1_audit.ButtonCode AND tb2_audit.RoleCode='super'
where tb1_audit.MenuCode = A.MenuCode and  tb1_audit.ButtonCode = 'audit'  
)as 'btn_audit' ,(
select case when max(tb1_inport.ID) is null then -1 
            when max(tb2_inport.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_inport
left join sys_roleMenuButtonMap AS tb2_inport ON tb2_inport.MenuCode=tb1_inport.MenuCode AND tb2_inport.ButtonCode=tb1_inport.ButtonCode AND tb2_inport.RoleCode='super'
where tb1_inport.MenuCode = A.MenuCode and  tb1_inport.ButtonCode = 'inport'  
)as 'btn_inport' ,(
select case when max(tb1_copy.ID) is null then -1 
            when max(tb2_copy.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_copy
left join sys_roleMenuButtonMap AS tb2_copy ON tb2_copy.MenuCode=tb1_copy.MenuCode AND tb2_copy.ButtonCode=tb1_copy.ButtonCode AND tb2_copy.RoleCode='super'
where tb1_copy.MenuCode = A.MenuCode and  tb1_copy.ButtonCode = 'copy'  
)as 'btn_copy' ,(
select case when max(tb1_save.ID) is null then -1 
            when max(tb2_save.ID) is null then 0 
            else 1 end 
from  sys_menuButtonMap AS tb1_save
left join sys_roleMenuButtonMap AS tb2_save ON tb2_save.MenuCode=tb1_save.MenuCode AND tb2_save.ButtonCode=tb1_save.ButtonCode AND tb2_save.RoleCode='super'
where tb1_save.MenuCode = A.MenuCode and  tb1_save.ButtonCode = 'save'  
)as 'btn_save' 
from sys_menu as A
left join sys_menu B on B.MenuCode = A.ParentCode
where A.IsEnable = 1
order by A.MenuSeq,A.MenuCode
2020-01-08 21:40:07,714 [7220] DEBUG Servicesys_permission - 获取动态列表
2020-01-08 21:40:07,714 [7220] DEBUG Sys - select A.*
,case when B.PermissionCode is null then 0 else 1           end as checked
,case when B.PermissionCode is null then 0 else B.IsDefault end as IsDefault from sys_permission A
left join sys_rolePermissionMap B on B.RoleCode='super' and B.PermissionCode = A.PermissionCode 
2020-01-08 21:40:07,742 [1112] DEBUG Sys - select * from sys_roleMenuColumnMap where RoleCode = 'super'
2020-01-08 21:40:15,097 [10904] DEBUG Servicesys_role - 修改角色菜单权限
2020-01-08 21:40:15,104 [10904] DEBUG Sys - delete from sys_roleMenuMap where [RoleCode] = 'super'
2020-01-08 21:40:15,106 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10')
2020-01-08 21:40:15,107 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1019')
2020-01-08 21:40:15,107 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1002')
2020-01-08 21:40:15,108 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1001')
2020-01-08 21:40:15,109 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1009')
2020-01-08 21:40:15,110 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1010')
2020-01-08 21:40:15,111 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1013')
2020-01-08 21:40:15,112 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1007')
2020-01-08 21:40:15,113 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1006')
2020-01-08 21:40:15,114 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1011')
2020-01-08 21:40:15,115 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1003')
2020-01-08 21:40:15,116 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1012')
2020-01-08 21:40:15,117 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1008')
2020-01-08 21:40:15,117 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1005')
2020-01-08 21:40:15,118 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1004')
2020-01-08 21:40:15,119 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0101')
2020-01-08 21:40:15,120 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100101')
2020-01-08 21:40:15,121 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100201')
2020-01-08 21:40:15,122 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100312')
2020-01-08 21:40:15,123 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100401')
2020-01-08 21:40:15,124 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100501')
2020-01-08 21:40:15,125 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100601')
2020-01-08 21:40:15,125 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100701')
2020-01-08 21:40:15,126 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100801')
2020-01-08 21:40:15,127 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','100901')
2020-01-08 21:40:15,128 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101001')
2020-01-08 21:40:15,129 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101101')
2020-01-08 21:40:15,130 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101201')
2020-01-08 21:40:15,131 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','101301')
2020-01-08 21:40:15,132 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4000')
2020-01-08 21:40:15,132 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4000201')
2020-01-08 21:40:15,137 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','4002')
2020-01-08 21:40:15,138 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','11')
2020-01-08 21:40:15,142 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1105')
2020-01-08 21:40:15,143 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1101')
2020-01-08 21:40:15,144 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1102')
2020-01-08 21:40:15,145 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1103')
2020-01-08 21:40:15,145 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1104')
2020-01-08 21:40:15,146 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1109')
2020-01-08 21:40:15,147 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','03')
2020-01-08 21:40:15,148 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0301')
2020-01-08 21:40:15,149 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0302')
2020-01-08 21:40:15,150 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0303')
2020-01-08 21:40:15,151 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','0304')
2020-01-08 21:40:15,152 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','12')
2020-01-08 21:40:15,152 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1204')
2020-01-08 21:40:15,153 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1201')
2020-01-08 21:40:15,154 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1202')
2020-01-08 21:40:15,155 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','1203')
2020-01-08 21:40:15,156 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','99')
2020-01-08 21:40:15,157 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9902')
2020-01-08 21:40:15,158 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9903')
2020-01-08 21:40:15,158 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9910')
2020-01-08 21:40:15,159 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9904')
2020-01-08 21:40:15,160 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9905')
2020-01-08 21:40:15,161 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9906')
2020-01-08 21:40:15,162 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9911')
2020-01-08 21:40:15,163 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9907')
2020-01-08 21:40:15,164 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','98')
2020-01-08 21:40:15,165 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9810')
2020-01-08 21:40:15,165 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9915')
2020-01-08 21:40:15,167 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9920')
2020-01-08 21:40:15,168 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9950')
2020-01-08 21:40:15,170 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9960')
2020-01-08 21:40:15,171 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','9961')
2020-01-08 21:40:15,172 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10000')
2020-01-08 21:40:15,173 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10001')
2020-01-08 21:40:15,173 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10010')
2020-01-08 21:40:15,174 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10012')
2020-01-08 21:40:15,175 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10002')
2020-01-08 21:40:15,176 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10003')
2020-01-08 21:40:15,177 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10004')
2020-01-08 21:40:15,178 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10005')
2020-01-08 21:40:15,179 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10006')
2020-01-08 21:40:15,180 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10007')
2020-01-08 21:40:15,180 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10008')
2020-01-08 21:40:15,181 [10904] DEBUG Sys - insert into sys_roleMenuMap([RoleCode],[MenuCode]) values('super','10009')
2020-01-08 21:40:15,188 [10904] DEBUG Servicesys_role - 修改角色菜单按钮权限
2020-01-08 21:40:15,190 [10904] DEBUG Sys - delete from sys_roleMenuButtonMap where [RoleCode] = 'super'
2020-01-08 21:40:15,191 [10904] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','add')
2020-01-08 21:40:15,192 [10904] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','edit')
2020-01-08 21:40:15,193 [10904] DEBUG Sys - insert into sys_roleMenuButtonMap([RoleCode],[MenuCode],[ButtonCode]) values('super','1001','delete')
2020-01-08 21:40:15,198 [10904] DEBUG Servicesys_role - 修改角色数据权限
2020-01-08 21:40:15,200 [10904] DEBUG Sys - delete from sys_rolePermissionMap where [RoleCode] = 'super'
2020-01-08 21:40:15,205 [10904] DEBUG Servicesys_role - 修改角色数据列权限
2020-01-08 21:40:15,210 [10904] DEBUG Sys - delete from sys_roleMenuColumnMap where [RoleCode] = 'super'
2020-01-08 21:40:15,221 [10904] DEBUG Sys - insert into sys_roleMenuColumnMap([RoleCode],[MenuCode],[IsReject],[FieldName]) values('super','1001','True','BillNo')
2020-01-08 21:40:17,714 [10904] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:40:18,046 [5432] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:40:19,069 [9420] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/role/Index','/Sys/role')
2020-01-08 21:40:19,074 [9420] DEBUG Servicesys_user - 获取动态列表
2020-01-08 21:40:19,074 [9420] DEBUG Sys - select UserCode,UserName from sys_user
2020-01-08 21:40:19,080 [9420] DEBUG Servicesys_organize - 获取动态列表
2020-01-08 21:40:19,081 [9420] DEBUG Sys - select OrganizeCode,OrganizeName from sys_organize
2020-01-08 21:40:19,936 [7220] DEBUG Servicesys_role - 获取实体列表
2020-01-08 21:40:19,936 [7220] DEBUG Sys - select sys_role.* from sys_role order by RoleSeq
2020-01-08 21:40:22,599 [7012] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:40:22,603 [7012] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:40:22,604 [7012] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:40:22,605 [7012] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:40:22,605 [7012] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:40:23,784 [5432] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:40:23,785 [5432] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:40:23,788 [5432] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:40:24,890 [6428] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:40:24,891 [6428] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:40:24,977 [8396] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:40:24,989 [8396] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:40:24,990 [8396] DEBUG Erp - select erp_construction.* from erp_construction where  BillNo =  '202001080002'
2020-01-08 21:40:24,996 [8396] ERROR Serviceerp_construction - 获取实体对象失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QuerySingle(Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 129
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass46_0.<GetModel>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 51
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:b30ab4e1-95a5-47cf-970d-fe78ad28a4f8
Error Number:207,State:1,Class:16
2020-01-08 21:40:25,048 [8396] ERROR /erp/ErpConstruction/edit/202001080002 - System.Data.SqlClient.SqlException (0x80131904): 列名 'BillNo' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetModel(ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 51
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetEditMaster(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 86
   在 ERP.Web.Areas.Erp.Controllers.ErpConstructionController.Edit(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\ErpConstructionController.cs:行号 40
   在 lambda_method(Closure , ControllerBase , Object[] )
   在 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   在 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
   在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)
ClientConnectionId:b30ab4e1-95a5-47cf-970d-fe78ad28a4f8
Error Number:207,State:1,Class:16
2020-01-08 21:41:32,373 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,386 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,390 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,390 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,393 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,393 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:41:32,696 [6428] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:41:35,298 [8836] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:41:42,655 [7220] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:41:42,688 [7220] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:41:42,720 [7220] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:41:42,739 [7220] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:41:42,741 [7220] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:41:52,291 [6428] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:41:52,291 [6428] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:41:52,313 [6428] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:41:53,871 [1112] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:41:53,876 [1112] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:41:54,142 [8836] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:41:54,158 [8836] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:41:54,161 [8836] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:41:54,167 [8836] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:41:54,211 [8836] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:41:54,213 [8836] DEBUG Erp - select top 1 no from erp_construction where  ProjectCode =  '201306030001' order by no
2020-01-08 21:41:54,481 [8836] ERROR Serviceerp_construction - 获取字段失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QueryValue[TField]() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 165
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass48_0`1.<GetField>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:41:54,585 [8836] ERROR Serviceerp_construction - 获取上一条下一条数据失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetField[TField](ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass12_0.<ScrollKeys>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 84
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:42:23,760 [8836] ERROR /erp/ErpConstruction/edit/202001080001 - System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.ScrollKeys(String key, String value, ParamQuery where) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 65
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetEditMaster(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 86
   在 ERP.Web.Areas.Erp.Controllers.ErpConstructionController.Edit(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\ErpConstructionController.cs:行号 40
   在 lambda_method(Closure , ControllerBase , Object[] )
   在 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   在 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
   在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:42:26,490 [11936] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:42:26,495 [11936] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:42:26,495 [11936] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:42:26,500 [11936] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:42:26,501 [11936] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:42:28,656 [11972] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:42:28,656 [11972] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:42:28,657 [11972] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:42:29,312 [11968] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:42:29,312 [11968] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:42:29,384 [10904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:43:05,057 [10904] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:43:05,058 [10904] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080002'
2020-01-08 21:43:05,060 [10904] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:43:05,060 [10904] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:43:05,060 [10904] DEBUG Erp - select top 1 no from erp_construction where  ProjectCode =  '201306030001' order by no
2020-01-08 21:43:05,062 [10904] ERROR Serviceerp_construction - 获取字段失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QueryValue[TField]() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 165
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass48_0`1.<GetField>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:43:05,063 [10904] ERROR Serviceerp_construction - 获取上一条下一条数据失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetField[TField](ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass12_0.<ScrollKeys>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 84
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:43:05,085 [10904] ERROR /erp/ErpConstruction/edit/202001080002 - System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.ScrollKeys(String key, String value, ParamQuery where) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 65
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetEditMaster(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 86
   在 ERP.Web.Areas.Erp.Controllers.ErpConstructionController.Edit(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\ErpConstructionController.cs:行号 40
   在 lambda_method(Closure , ControllerBase , Object[] )
   在 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   在 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
   在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)
ClientConnectionId:3f09bac0-7934-49a0-82c4-7aa95c3a04d8
Error Number:207,State:1,Class:16
2020-01-08 21:43:29,584 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:29,610 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:29,617 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:29,618 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:29,623 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:29,624 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:43:30,223 [9488] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:43:34,492 [9488] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:44:25,963 [3376] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:25,992 [3376] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:26,001 [3376] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:26,001 [3376] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:26,008 [3376] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:26,009 [3376] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:44:26,658 [11592] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:44:30,877 [10904] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:44:37,603 [10904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:44:37,635 [10904] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:44:37,670 [10904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:44:37,683 [10904] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:44:37,684 [10904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:44:40,095 [3016] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:44:40,095 [3016] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:44:40,111 [3016] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:44:41,189 [9488] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:44:41,194 [9488] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:44:41,492 [11900] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:44:41,505 [11900] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:44:41,507 [11900] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:44:41,510 [11900] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:44:41,545 [11900] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:44:41,547 [11900] DEBUG Erp - select top 1 no from erp_construction where  ProjectCode =  '201306030001' order by no
2020-01-08 21:44:41,551 [11900] ERROR Serviceerp_construction - 获取字段失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Data.ExecuteQueryHandler.HandleQueryException(Exception exception) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 107
   在 Zephyr.Data.ExecuteQueryHandler.ExecuteQuery(Boolean useReader, Action action) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\Handlers\ExecuteQueryHandler.cs:行号 28
   在 Zephyr.Data.DbCommand.QuerySingle[TEntity](Action`2 customMapper) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Command\PartialClasses\QuerySingle.cs:行号 12
   在 Zephyr.Data.SelectBuilder`1.QueryValue[TField]() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Data\Builders\Select\SelectBuilder.cs:行号 165
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass48_0`1.<GetField>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:94b41033-ae77-484d-a562-61c4e216e2e8
Error Number:207,State:1,Class:16
2020-01-08 21:44:41,574 [11900] ERROR Serviceerp_construction - 获取上一条下一条数据失败
System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.GetField[TField](ParamQuery param) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseQuery.cs:行号 66
   在 Zephyr.Core.ServiceBase`1.<>c__DisplayClass12_0.<ScrollKeys>b__0() 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 84
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 44
ClientConnectionId:94b41033-ae77-484d-a562-61c4e216e2e8
Error Number:207,State:1,Class:16
2020-01-08 21:44:41,595 [11900] ERROR /erp/ErpConstruction/edit/202001080001 - System.Data.SqlClient.SqlException (0x80131904): 列名 'ProjectCode' 无效。
   在 Zephyr.Core.LogHelper.Logger(ILog log, String function, ErrorHandle errorHandleType, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Logs\LogHelper.cs:行号 54
   在 Zephyr.Core.ServiceBase`1.Logger(String function, Action tryHandle, Action`1 catchHandle, Action finallyHandle) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBaseLog.cs:行号 23
   在 Zephyr.Core.ServiceBase`1.ScrollKeys(String key, String value, ParamQuery where) 位置 D:\Project\Code\WEBERP\Code\Zephyr.Net\Zephyr.Core\Base\ServiceBase.cs:行号 65
   在 ERP.Web.Areas.Erp.Controllers.ErpBaseApi`4.GetEditMaster(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Common\ErpBaseApi.cs:行号 86
   在 ERP.Web.Areas.Erp.Controllers.ErpConstructionController.Edit(String id) 位置 D:\Project\Code\WEBERP\Code\ERP.Web\Areas\Erp\Controllers\ErpConstructionController.cs:行号 40
   在 lambda_method(Closure , ControllerBase , Object[] )
   在 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
   在 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
   在 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()
   在 System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<BeginInvokeActionMethodWithFilters>b__36(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()
   在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)
ClientConnectionId:94b41033-ae77-484d-a562-61c4e216e2e8
Error Number:207,State:1,Class:16
2020-01-08 21:45:35,154 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:35,200 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:35,212 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:35,213 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:35,224 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:35,225 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:45:36,157 [9092] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:45:41,694 [11968] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:46:11,179 [5784] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:46:11,401 [9092] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:46:15,685 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:46:15,719 [2480] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:46:15,742 [2480] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:46:15,746 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:46:15,747 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:46:18,315 [5784] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:46:18,316 [5784] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:46:18,338 [5784] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:46:19,471 [9092] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:46:19,475 [9092] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:46:19,659 [9488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:46:19,671 [9488] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:46:19,673 [9488] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:46:19,675 [9488] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:46:19,711 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:46:19,713 [9488] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:46:19,717 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:46:19,717 [9488] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080001' order by no desc
2020-01-08 21:46:19,721 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:46:19,722 [9488] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080001' order by no
2020-01-08 21:46:19,726 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:46:19,726 [9488] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:46:19,766 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:46:19,766 [9488] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:46:19,767 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:46:19,767 [9488] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:46:19,768 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:46:19,768 [9488] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:46:19,769 [9488] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:46:19,769 [9488] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:46:19,771 [9488] DEBUG Servicesys_code - 获取字段
2020-01-08 21:46:19,771 [9488] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:46:19,772 [9488] DEBUG Servicesys_code - 获取字段
2020-01-08 21:46:19,772 [9488] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:46:25,750 [11968] DEBUG ServiceModelBase - 获取动态列表
2020-01-08 21:46:25,751 [11968] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2020-01-08 21:46:25,770 [11968] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2020-01-08 21:47:06,978 [2480] DEBUG ServiceModelBase - 获取动态列表
2020-01-08 21:47:06,978 [2480] DEBUG Mms - select top 20 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') order by MerchantsCode
2020-01-08 21:47:06,986 [2480] DEBUG Mms - select count(*) from ( select 
    MerchantsCode   as   value,MerchantsName   as   text
   from 
    mms_merchants A
    left join mms_merchantsType B on B.MerchantsTypeCode = A.MerchantsTypeCode
   where  B.MerchantsProperty in ('采购') ) tb_temp
2020-01-08 21:48:04,409 [8324] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:48:04,943 [5784] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:48:06,001 [10904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:48:06,004 [10904] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:48:06,005 [10904] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:48:06,005 [10904] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:48:06,005 [10904] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,005 [10904] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:48:06,006 [10904] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,006 [10904] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080001' order by no desc
2020-01-08 21:48:06,007 [10904] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,007 [10904] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080001' order by no
2020-01-08 21:48:06,007 [10904] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,007 [10904] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:48:06,008 [10904] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,008 [10904] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:48:06,009 [10904] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,009 [10904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:48:06,009 [10904] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,010 [10904] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:48:06,010 [10904] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:48:06,010 [10904] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:48:06,011 [10904] DEBUG Servicesys_code - 获取字段
2020-01-08 21:48:06,011 [10904] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:48:06,012 [10904] DEBUG Servicesys_code - 获取字段
2020-01-08 21:48:06,012 [10904] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:48:06,033 [9488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:48:06,035 [9488] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:48:06,036 [9488] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:48:06,036 [9488] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:48:06,036 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,036 [9488] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:48:06,036 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,037 [9488] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080001' order by no desc
2020-01-08 21:48:06,037 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,037 [9488] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080001' order by no
2020-01-08 21:48:06,037 [9488] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:48:06,037 [9488] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:48:06,038 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,038 [9488] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:48:06,039 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,039 [9488] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:48:06,041 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:48:06,041 [9488] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:48:06,042 [9488] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:48:06,042 [9488] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:48:06,042 [9488] DEBUG Servicesys_code - 获取字段
2020-01-08 21:48:06,042 [9488] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:48:06,043 [9488] DEBUG Servicesys_code - 获取字段
2020-01-08 21:48:06,043 [9488] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:48:22,788 [10904] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:48:24,625 [3980] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:48:24,626 [3980] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:48:36,935 [8324] DEBUG Servicesys_menu - 编辑记录
2020-01-08 21:48:36,963 [8324] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:48:36,969 [8324] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '4002'
2020-01-08 21:48:36,999 [8324] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '施工单', [MenuCode] = '4002', [ParentCode] = '4000', [IconClass] = 'icon-award_star_bronze_3', [URL] = '', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '2', [UpdatePerson] = '超级管理员', [UpdateDate] = '2020/1/8 21:48:36' where  MenuCode =  '4002'
2020-01-08 21:48:37,069 [8324] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"4002","MenuName":"施工单","MenuCode":"4002","ParentCode":"4000","IconClass":"icon-award_star_bronze_3","URL":"","IsVisible":"true","IsEnable":"true","MenuSeq":"2"}],"_changed":true}}','2020/1/8 21:48:37')
2020-01-08 21:48:37,399 [3980] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:48:37,399 [3980] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:48:39,227 [7908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:48:39,603 [3016] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:48:40,637 [3980] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:48:41,513 [5784] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:48:41,513 [5784] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:48:55,548 [5784] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:48:56,048 [11592] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:48:56,048 [11592] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:49:16,700 [11968] DEBUG Servicesys_menu - 编辑记录
2020-01-08 21:49:16,701 [11968] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:49:16,701 [11968] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '4000'
2020-01-08 21:49:16,704 [11968] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '施工单管理', [MenuCode] = '4000', [ParentCode] = '', [IconClass] = 'icon-calendar_edit', [URL] = '', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '2', [UpdatePerson] = '超级管理员', [UpdateDate] = '2020/1/8 21:49:16' where  MenuCode =  '4000'
2020-01-08 21:49:16,739 [11968] DEBUG Servicesys_menu - 获取动态对象
2020-01-08 21:49:16,739 [11968] DEBUG Sys - select 
        sys_menu
    .* from 
        sys_menu
     where  MenuCode =  '4002'
2020-01-08 21:49:16,740 [11968] DEBUG Sys - update 
        sys_menu
     set [MenuName] = '施工单', [MenuCode] = '4002', [ParentCode] = '4000', [IconClass] = 'icon-award_star_bronze_3', [URL] = '/erp/ErpConstruction', [IsVisible] = 'true', [IsEnable] = 'true', [MenuSeq] = '2', [UpdatePerson] = '超级管理员', [UpdateDate] = '2020/1/8 21:49:16' where  MenuCode =  '4002'
2020-01-08 21:49:16,766 [11968] DEBUG Sys - insert into sys_log([UserCode],[UserName],[Position],[Target],[Type],[Message],[Date]) values('super','超级管理员','api/mms/send','菜单数据','修改','{"list":{"deleted":[],"inserted":[],"updated":[{"_id":"4000","MenuName":"施工单管理","MenuCode":"4000","ParentCode":"","IconClass":"icon-calendar_edit","URL":"","IsVisible":"true","IsEnable":"true","MenuSeq":"2"},{"_id":"4002","MenuName":"施工单","MenuCode":"4002","ParentCode":"4000","IconClass":"icon-award_star_bronze_3","URL":"/erp/ErpConstruction","IsVisible":"true","IsEnable":"true","MenuSeq":"2"}],"_changed":true}}','2020/1/8 21:49:16')
2020-01-08 21:49:17,020 [8324] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:49:17,020 [8324] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:49:18,398 [7908] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:49:18,646 [3980] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:49:19,818 [11592] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Sys/menu/Index','/Sys/menu')
2020-01-08 21:49:20,637 [8324] DEBUG Servicesys_menu - 获取动态列表
2020-01-08 21:49:20,637 [8324] DEBUG Sys - select A.*,B.MenuName as ParentName from sys_menu A left join sys_menu B on B.MenuCode = A.ParentCode order by A.MenuSeq,A.MenuCode
2020-01-08 21:49:24,204 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:49:24,208 [2480] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:24,208 [2480] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:24,209 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:24,209 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:25,152 [5784] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:49:25,152 [5784] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:49:25,153 [5784] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:49:26,769 [3980] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:49:26,769 [3980] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:49:26,856 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:49:26,860 [2480] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:49:26,860 [2480] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080002'
2020-01-08 21:49:26,861 [2480] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:49:26,861 [2480] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:26,861 [2480] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:49:26,862 [2480] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:26,862 [2480] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080002' order by no desc
2020-01-08 21:49:26,865 [2480] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:26,865 [2480] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080002' order by no
2020-01-08 21:49:26,867 [2480] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:26,868 [2480] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:49:26,870 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:26,870 [2480] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:49:26,872 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:26,872 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:26,873 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:26,873 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:49:26,874 [2480] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:26,875 [2480] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:26,877 [2480] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:26,877 [2480] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:49:26,878 [2480] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:26,878 [2480] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:49:33,607 [9488] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/Index','/Mms/receive')
2020-01-08 21:49:33,617 [9488] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:33,617 [9488] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:33,618 [9488] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:33,618 [9488] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:36,152 [8324] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 21:49:36,152 [8324] DEBUG Mms - select top 20 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' order by A.BillNo
2020-01-08 21:49:36,171 [8324] DEBUG Mms - select count(*) from ( select 
        A.*, B.ProjectName, C.MaterialTypeName, D.WarehouseName as WarehouseName, E.MerchantsName AS SupplierName
     from 
        mms_receive A
        left join mms_project       B on B.ProjectCode      = A.ProjectCode
        left join mms_materialType  C on C.MaterialType = A.MaterialType
        left join mms_warehouse         D on D.WarehouseCode       = A.WarehouseCode
        left join mms_merchants     E on E.MerchantsCode    = A.SupplierCode
     where  A.ProjectCode =  '201306030001' ) tb_temp
2020-01-08 21:49:37,102 [7736] DEBUG Servicemms_receive - 获取新主键
2020-01-08 21:49:37,102 [7736] DEBUG Mms - select isnull(max(BillNo),0) from mms_receive
2020-01-08 21:49:37,203 [2480] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Mms/receive/edit')
2020-01-08 21:49:37,215 [2480] DEBUG Servicemms_receive - 获取实体对象
2020-01-08 21:49:37,215 [2480] DEBUG Mms - select mms_receive.* from mms_receive where  BillNo =  '202001080001'
2020-01-08 21:49:37,217 [2480] DEBUG Servicemms_receive - 获取上一条下一条数据
2020-01-08 21:49:37,220 [2480] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:49:37,221 [2480] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo
2020-01-08 21:49:37,226 [2480] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:49:37,226 [2480] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo < '202001080001'and ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 21:49:37,231 [2480] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:49:37,231 [2480] DEBUG Mms - select top 1 BillNo from mms_receive where  BillNo >  '202001080001'and ProjectCode =  '201306030001' order by BillNo
2020-01-08 21:49:37,235 [2480] DEBUG Servicemms_receive - 获取字段
2020-01-08 21:49:37,235 [2480] DEBUG Mms - select top 1 BillNo from mms_receive where  ProjectCode =  '201306030001' order by BillNo desc
2020-01-08 21:49:37,297 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:37,297 [2480] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:49:37,298 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:37,298 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:37,299 [2480] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:37,299 [2480] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:49:37,300 [2480] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:37,300 [2480] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:37,301 [2480] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:37,301 [2480] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:49:37,302 [2480] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:37,302 [2480] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:49:39,850 [11968] DEBUG Servicemms_receive - 获取动态列表
2020-01-08 21:49:39,851 [11968] DEBUG Mms - select 
        A.*, B.MaterialName,B.Model,B.Material
     from 
        mms_receiveDetail A
        left join mms_material B on B.MaterialCode = A.MaterialCode
     where  BillNo =  '202001080001' order by A.MaterialCode
2020-01-08 21:49:52,316 [11968] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:49:52,320 [11968] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:52,321 [11968] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:52,322 [11968] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:52,322 [11968] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:53,304 [3980] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:49:53,304 [3980] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:49:53,307 [3980] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:49:54,398 [9488] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:49:54,399 [9488] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:49:54,535 [11592] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:49:54,539 [11592] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:49:54,540 [11592] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080003'
2020-01-08 21:49:54,543 [11592] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:49:54,544 [11592] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:54,544 [11592] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:49:54,544 [11592] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:54,545 [11592] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080003' order by no desc
2020-01-08 21:49:54,548 [11592] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:54,548 [11592] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080003' order by no
2020-01-08 21:49:54,551 [11592] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:49:54,551 [11592] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:49:54,552 [11592] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:54,552 [11592] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:49:54,553 [11592] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:54,553 [11592] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:49:54,554 [11592] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:49:54,554 [11592] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:49:54,555 [11592] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:49:54,556 [11592] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:49:54,557 [11592] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:54,557 [11592] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:49:54,558 [11592] DEBUG Servicesys_code - 获取字段
2020-01-08 21:49:54,558 [11592] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:51:54,974 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:54,993 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:54,997 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:54,998 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:55,001 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:55,001 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 21:51:55,386 [7736] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:51:58,252 [3980] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:52:01,774 [9300] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:52:01,854 [9300] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:52:01,891 [9300] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:52:01,897 [9300] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:52:01,898 [9300] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:52:05,250 [9300] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:52:05,251 [9300] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:52:05,267 [9300] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:52:06,549 [7736] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:52:06,554 [7736] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:52:06,813 [7908] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:52:15,445 [7908] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:52:15,447 [7908] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:52:15,469 [7908] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:52:15,505 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:15,508 [7908] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:52:15,511 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:15,511 [7908] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080001' order by no desc
2020-01-08 21:52:15,514 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:15,514 [7908] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080001' order by no
2020-01-08 21:52:15,516 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:15,517 [7908] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:52:59,768 [7908] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:52:59,769 [7908] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080001'
2020-01-08 21:52:59,772 [7908] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:52:59,773 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:59,773 [7908] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:52:59,774 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:59,774 [7908] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080001' order by no desc
2020-01-08 21:52:59,782 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:59,783 [7908] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080001' order by no
2020-01-08 21:52:59,791 [7908] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:52:59,791 [7908] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:52:59,808 [7908] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:52:59,809 [7908] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:52:59,818 [7908] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:52:59,818 [7908] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:52:59,840 [7908] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:52:59,841 [7908] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:52:59,880 [7908] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:52:59,880 [7908] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:52:59,883 [7908] DEBUG Servicesys_code - 获取字段
2020-01-08 21:52:59,884 [7908] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:52:59,894 [7908] DEBUG Servicesys_code - 获取字段
2020-01-08 21:52:59,895 [7908] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:53:03,257 [8524] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:53:03,257 [8524] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:53:03,336 [6332] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:54:09,871 [6332] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:54:09,872 [6332] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080002'
2020-01-08 21:54:09,910 [6332] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:54:09,910 [6332] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:54:09,910 [6332] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:54:09,912 [6332] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:54:09,912 [6332] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080002' order by no desc
2020-01-08 21:54:09,963 [6332] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:54:09,963 [6332] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080002' order by no
2020-01-08 21:54:09,971 [6332] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:54:09,971 [6332] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:54:10,001 [6332] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:54:10,001 [6332] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:54:10,003 [6332] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:54:10,003 [6332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:54:10,005 [6332] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:54:10,005 [6332] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:54:10,007 [6332] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:54:10,007 [6332] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:54:10,009 [6332] DEBUG Servicesys_code - 获取字段
2020-01-08 21:54:10,009 [6332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:54:10,009 [6332] DEBUG Servicesys_code - 获取字段
2020-01-08 21:54:10,010 [6332] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:55:09,499 [11548] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 21:55:10,395 [8524] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 21:55:40,169 [2712] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 21:55:40,175 [2712] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:55:40,175 [2712] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:55:40,187 [2712] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:55:40,188 [2712] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:55:41,263 [11992] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 21:55:41,263 [11992] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 21:55:41,265 [11992] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 21:56:01,726 [8524] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 21:56:01,726 [8524] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 21:59:18,997 [9928] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 21:59:19,002 [9928] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 21:59:19,003 [9928] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '202001080003'
2020-01-08 21:59:19,043 [9928] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 21:59:19,044 [9928] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:59:19,044 [9928] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 21:59:19,057 [9928] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:59:19,057 [9928] DEBUG Erp - select top 1 no from erp_construction where  no < '202001080003' order by no desc
2020-01-08 21:59:19,058 [9928] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:59:19,058 [9928] DEBUG Erp - select top 1 no from erp_construction where  no >  '202001080003' order by no
2020-01-08 21:59:19,058 [9928] DEBUG Serviceerp_construction - 获取字段
2020-01-08 21:59:19,059 [9928] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 21:59:19,059 [9928] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:59:19,060 [9928] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 21:59:19,061 [9928] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:59:19,061 [9928] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 21:59:19,062 [9928] DEBUG Servicesys_code - 获取动态列表
2020-01-08 21:59:19,062 [9928] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 21:59:19,063 [9928] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 21:59:19,064 [9928] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 21:59:19,064 [9928] DEBUG Servicesys_code - 获取字段
2020-01-08 21:59:19,065 [9928] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 21:59:19,066 [9928] DEBUG Servicesys_code - 获取字段
2020-01-08 21:59:19,066 [9928] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:08:38,833 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:38,869 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:38,880 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:38,880 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:38,890 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:38,890 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:08:39,669 [10416] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:08:44,582 [1112] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:09:05,342 [9976] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:09:05,370 [9976] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:09:05,405 [9976] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:09:05,407 [9976] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:09:05,408 [9976] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:09:08,066 [7652] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:09:08,067 [7652] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:09:08,085 [7652] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:09:30,674 [9976] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:09:31,470 [1112] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:09:34,100 [3512] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:09:34,101 [3512] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:09:34,101 [3512] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:09:34,102 [3512] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:09:34,102 [3512] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:09:34,953 [8072] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:09:34,953 [8072] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:09:34,954 [8072] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:10:56,807 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:56,847 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:56,859 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:56,860 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:56,873 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:56,874 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:10:57,689 [3512] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:11:02,406 [7652] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:12:52,635 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,646 [7340] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,650 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,650 [7340] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,653 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,653 [7340] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:12:52,896 [1112] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:12:54,763 [9976] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:13:01,730 [1112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:13:01,775 [1112] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:13:01,795 [1112] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:13:01,799 [1112] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:01,800 [1112] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:13:03,911 [11552] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:13:03,912 [11552] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:13:03,923 [11552] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:13:04,811 [8072] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:13:04,988 [10416] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 22:13:05,001 [10416] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 22:13:05,004 [10416] DEBUG Erp - select erp_construction.* from erp_construction where  no =  ''
2020-01-08 22:13:05,008 [10416] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 22:13:05,043 [10416] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:05,045 [10416] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 22:13:05,049 [10416] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:05,049 [10416] DEBUG Erp - select top 1 no from erp_construction where  no < '' order by no desc
2020-01-08 22:13:05,053 [10416] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:05,054 [10416] DEBUG Erp - select top 1 no from erp_construction where  no >  '' order by no
2020-01-08 22:13:05,058 [10416] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:05,058 [10416] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 22:13:05,096 [10416] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:05,096 [10416] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 22:13:05,098 [10416] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:05,098 [10416] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:13:05,098 [10416] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:05,099 [10416] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 22:13:05,099 [10416] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:13:05,099 [10416] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:13:05,102 [10416] DEBUG Servicesys_code - 获取字段
2020-01-08 22:13:05,102 [10416] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:13:05,103 [10416] DEBUG Servicesys_code - 获取字段
2020-01-08 22:13:05,103 [10416] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:13:13,846 [8072] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:13:14,546 [9724] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:13:15,621 [1112] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 22:13:15,625 [1112] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 22:13:15,625 [1112] DEBUG Erp - select erp_construction.* from erp_construction where  no =  ''
2020-01-08 22:13:15,626 [1112] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 22:13:15,626 [1112] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:15,626 [1112] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 22:13:15,627 [1112] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:15,627 [1112] DEBUG Erp - select top 1 no from erp_construction where  no < '' order by no desc
2020-01-08 22:13:15,627 [1112] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:15,627 [1112] DEBUG Erp - select top 1 no from erp_construction where  no >  '' order by no
2020-01-08 22:13:15,628 [1112] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:13:15,628 [1112] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 22:13:15,629 [1112] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:15,629 [1112] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 22:13:15,630 [1112] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:15,630 [1112] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:13:15,630 [1112] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:15,631 [1112] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 22:13:15,631 [1112] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:13:15,631 [1112] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:13:15,632 [1112] DEBUG Servicesys_code - 获取字段
2020-01-08 22:13:15,632 [1112] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:13:15,633 [1112] DEBUG Servicesys_code - 获取字段
2020-01-08 22:13:15,633 [1112] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:13:36,512 [3512] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:13:37,818 [9976] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:13:41,313 [9860] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:13:41,317 [9860] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:13:41,318 [9860] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:13:41,320 [9860] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:13:41,320 [9860] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:13:43,243 [7712] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:13:43,243 [7712] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:13:43,244 [7712] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:14:15,869 [11552] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:14:16,024 [8072] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 22:14:16,029 [8072] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 22:14:16,029 [8072] DEBUG Erp - select erp_construction.* from erp_construction where  no =  ''
2020-01-08 22:14:16,030 [8072] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 22:14:16,031 [8072] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:14:16,031 [8072] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 22:14:16,031 [8072] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:14:16,031 [8072] DEBUG Erp - select top 1 no from erp_construction where  no < '' order by no desc
2020-01-08 22:14:16,032 [8072] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:14:16,033 [8072] DEBUG Erp - select top 1 no from erp_construction where  no >  '' order by no
2020-01-08 22:14:16,033 [8072] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:14:16,033 [8072] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 22:14:16,034 [8072] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:14:16,034 [8072] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 22:14:16,035 [8072] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:14:16,036 [8072] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:14:16,051 [8072] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:14:16,051 [8072] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 22:14:16,067 [8072] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:14:16,067 [8072] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:14:16,073 [8072] DEBUG Servicesys_code - 获取字段
2020-01-08 22:14:16,073 [8072] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:14:16,080 [8072] DEBUG Servicesys_code - 获取字段
2020-01-08 22:14:16,081 [8072] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:14:35,172 [7712] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:15:00,884 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:00,929 [8860] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:00,942 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:00,943 [8860] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:00,954 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:00,955 [8860] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:15:01,965 [9860] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:15:07,483 [3512] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:15:11,002 [7712] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:15:11,053 [7712] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:15:11,076 [7712] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:15:11,084 [7712] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:15:11,087 [7712] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:15:13,578 [8072] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:15:13,579 [8072] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:15:13,597 [8072] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:15:14,927 [11552] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:15:14,932 [11552] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 22:15:15,170 [9860] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 22:15:15,191 [9860] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 22:15:15,194 [9860] DEBUG Erp - select erp_construction.* from erp_construction where  no =  '1'
2020-01-08 22:15:15,198 [9860] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 22:15:15,263 [9860] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:15:15,266 [9860] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 22:15:15,270 [9860] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:15:15,271 [9860] DEBUG Erp - select top 1 no from erp_construction where  no < '1' order by no desc
2020-01-08 22:15:15,277 [9860] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:15:15,277 [9860] DEBUG Erp - select top 1 no from erp_construction where  no >  '1' order by no
2020-01-08 22:15:15,283 [9860] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:15:15,284 [9860] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 22:15:15,340 [9860] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:15:15,340 [9860] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 22:15:15,342 [9860] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:15:15,343 [9860] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:15:15,344 [9860] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:15:15,344 [9860] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 22:15:15,345 [9860] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:15:15,346 [9860] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:15:15,348 [9860] DEBUG Servicesys_code - 获取字段
2020-01-08 22:15:15,349 [9860] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:15:15,350 [9860] DEBUG Servicesys_code - 获取字段
2020-01-08 22:15:15,350 [9860] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:15:40,639 [9976] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:15:42,145 [9724] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:15:48,025 [7712] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:15:48,081 [7712] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:15:48,081 [7712] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:15:48,097 [7712] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:15:48,097 [7712] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:15:49,497 [9860] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:15:49,497 [9860] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:15:49,498 [9860] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:15:54,896 [7712] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:16:02,175 [7712] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 22:16:57,360 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:57,403 [3068] DEBUG Sys - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:57,417 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:57,419 [3068] DEBUG Mms - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:57,431 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:57,432 [3068] DEBUG Erp - select name from dbo.sysobjects where id = object_id(N'[dbo].[fun_getPY]') and xtype in (N'FN', N'IF', N'TF')
2020-01-08 22:16:58,467 [11392] DEBUG Sys - select * from sys_userSetting where UserCode='super'
2020-01-08 22:17:03,497 [8072] DEBUG Sys - 
--角色的菜单
select distinct B.*
from sys_roleMenuMap A
inner join sys_menu  B on B.MenuCode = A.MenuCode
where B.IsEnable='1'
  and RoleCode in (
  select RoleCode from sys_userRoleMap where UserCode = 'super' --用户的角色
union all
  select RoleCode from sys_organizeRoleMap where OrganizeCode in  --机构的角色
  (
	select OrganizeCode from sys_userOrganizeMap where UserCode = 'super'
  )  
)
order by B.MenuSeq,B.MenuCode
2020-01-08 22:17:15,380 [11392] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/Index','/Erp/ErpConstruction')
2020-01-08 22:17:15,410 [11392] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:17:15,434 [11392] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:17:15,442 [11392] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:17:15,443 [11392] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:17:17,917 [2180] DEBUG Serviceerp_construction - 获取动态列表
2020-01-08 22:17:17,918 [2180] DEBUG Erp - select top 20 *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' order by id
2020-01-08 22:17:17,933 [2180] DEBUG Erp - select count(*) from ( select *
                 from 
                    Erp_Construction
                 where  no =  '201306030001' ) tb_temp
2020-01-08 22:17:19,278 [7712] DEBUG Serviceerp_construction - 获取新主键
2020-01-08 22:17:19,281 [7712] DEBUG Erp - select isnull(max(no),0) from erp_construction
2020-01-08 22:17:19,436 [9436] DEBUG Sys - 
select 1
from sys_roleMenuMap A
left join sys_userRoleMap B on B.RoleCode = A.RoleCode
left join sys_menu C on C.MenuCode = A.MenuCode
where B.UserCode = 'super'
and C.URL in ('/Erp/ErpConstruction/edit')
2020-01-08 22:17:19,443 [9436] DEBUG Serviceerp_construction - 获取实体对象
2020-01-08 22:17:19,444 [9436] DEBUG Erp - select erp_construction.* from erp_construction where  no =  'TO2020010000'
2020-01-08 22:17:19,445 [9436] DEBUG Serviceerp_construction - 获取上一条下一条数据
2020-01-08 22:17:19,464 [9436] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:17:19,465 [9436] DEBUG Erp - select top 1 no from erp_construction order by no
2020-01-08 22:17:19,467 [9436] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:17:19,467 [9436] DEBUG Erp - select top 1 no from erp_construction where  no < 'TO2020010000' order by no desc
2020-01-08 22:17:19,469 [9436] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:17:19,470 [9436] DEBUG Erp - select top 1 no from erp_construction where  no >  'TO2020010000' order by no
2020-01-08 22:17:19,472 [9436] DEBUG Serviceerp_construction - 获取字段
2020-01-08 22:17:19,472 [9436] DEBUG Erp - select top 1 no from erp_construction order by no desc
2020-01-08 22:17:19,492 [9436] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:17:19,493 [9436] DEBUG Sys - select Text as value,Text as text from sys_code where  CodeType =  'MeasureUnit'
2020-01-08 22:17:19,493 [9436] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:17:19,493 [9436] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'SupplyType'
2020-01-08 22:17:19,494 [9436] DEBUG Servicesys_code - 获取动态列表
2020-01-08 22:17:19,494 [9436] DEBUG Sys - select Code as value,Text as text from sys_code where  CodeType =  'PayType'
2020-01-08 22:17:19,494 [9436] DEBUG Servicemms_warehouse - 获取动态列表
2020-01-08 22:17:19,494 [9436] DEBUG Mms - select WarehouseCode as value,WarehouseName as text from mms_warehouse where  ProjectCode =  '201306030001'
2020-01-08 22:17:19,497 [9436] DEBUG Servicesys_code - 获取字段
2020-01-08 22:17:19,497 [9436] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'SupplyType'and IsEnable =  'True'and IsDefault =  'True'
2020-01-08 22:17:19,498 [9436] DEBUG Servicesys_code - 获取字段
2020-01-08 22:17:19,498 [9436] DEBUG Sys - select top 1 Code from sys_code where  CodeType =  'PayType'and IsEnable =  'True'and IsDefault =  'True'
